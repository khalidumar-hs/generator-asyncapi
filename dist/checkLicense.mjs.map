{"version":3,"sources":["../src/checkLicense.ts","../package.json"],"sourcesContent":["import chalk from 'chalk';\nimport pkg from '../package.json';\n\ntype LicenseResponse = {\n  is_trial: boolean;\n  plugin: string;\n  state: string;\n};\n\nexport default async (licenseKey?: string) => {\n  const LICENSE_KEY = process.env.EVENTCATALOG_LICENSE_KEY_ASYNCAPI || licenseKey || null;\n\n  if (!LICENSE_KEY) {\n    console.log(chalk.bgRed(`\\nThis plugin requires a license key to use`));\n    console.log(chalk.redBright(`\\nVisit https://eventcatalog.cloud/ to get a 14 day trial or purchase a license`));\n    process.exit(1);\n  }\n\n  // Verify the license key\n  const response = await fetch('https://api.eventcatalog.cloud/functions/v1/license', {\n    method: 'POST',\n    headers: {\n      Authorization: `Bearer ${LICENSE_KEY}`,\n      'Content-Type': 'application/json',\n    },\n  });\n\n  if (response.status !== 200) {\n    console.log(chalk.bgRed(`\\nInvalid license key`));\n    console.log(chalk.redBright('Please check your plugin license key or purchase a license at https://eventcatalog.cloud/'));\n    process.exit(1);\n  }\n\n  if (response.status === 200) {\n    const data = (await response.json()) as LicenseResponse;\n\n    if (pkg.name !== data.plugin) {\n      console.log(chalk.bgRed(`\\nInvalid license key for this plugin`));\n      console.log(chalk.redBright('Please check your plugin license key or purchase a license at https://eventcatalog.cloud/'));\n      process.exit(1);\n    }\n\n    if (data.is_trial) {\n      console.log(chalk.bgBlue(`\\nYou are using a trial license for this plugin`));\n    }\n  }\n\n  return Promise.resolve();\n};\n","{\n  \"name\": \"@khalidumar-hs/generator-asyncapi\",\n  \"version\": \"2.7.5\",\n  \"description\": \"AsyncAPI generator for EventCatalog\",\n  \"scripts\": {\n    \"build\": \"tsup\",\n    \"test\": \"vitest\",\n    \"format\": \"prettier --write .\",\n    \"format:diff\": \"prettier --list-different .\",\n    \"changeset\": \"changeset\",\n    \"release\": \"changeset publish\"\n  },\n  \"publishConfig\": {\n    \"access\": \"public\"\n  },\n  \"keywords\": [],\n  \"author\": \"khalidumar-hs\",\n  \"license\": \"ISC\",\n  \"devDependencies\": {\n    \"@changesets/cli\": \"^2.27.9\",\n    \"@types/fs-extra\": \"^11.0.4\",\n    \"@types/js-yaml\": \"^4.0.9\",\n    \"@types/lodash\": \"^4.17.7\",\n    \"@types/minimist\": \"^1.2.5\",\n    \"@types/node\": \"^20.16.1\",\n    \"prettier\": \"^3.3.3\",\n    \"tsup\": \"^8.1.0\",\n    \"typescript\": \"^5.5.3\",\n    \"vitest\": \"^2.0.2\"\n  },\n  \"files\": [\n    \"dist\",\n    \"package.json\"\n  ],\n  \"main\": \"./dist/index.js\",\n  \"module\": \"./dist/index.mjs\",\n  \"types\": \"./dist/index.d.ts\",\n  \"dependencies\": {\n    \"@asyncapi/avro-schema-parser\": \"^3.0.24\",\n    \"@asyncapi/parser\": \"^3.3.0\",\n    \"@eventcatalog/sdk\": \"^1.4.4\",\n    \"chalk\": \"^4\",\n    \"fs-extra\": \"^11.2.0\",\n    \"glob\": \"^11.0.0\",\n    \"gray-matter\": \"^4.0.3\",\n    \"js-yaml\": \"^4.1.0\",\n    \"lodash\": \"^4.17.21\",\n    \"minimist\": \"^1.2.8\",\n    \"slugify\": \"^1.6.6\",\n    \"zod\": \"^3.23.8\"\n  },\n  \"directories\": {\n    \"example\": \"examples\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/khalidumar-hs/generator-asyncapi.git\"\n  },\n  \"bugs\": {\n    \"url\": \"https://github.com/khalidumar-hs/generator-asyncapi/issues\"\n  },\n  \"homepage\": \"https://github.com/khalidumar-hs/generator-asyncapi#readme\"\n}\n"],"mappings":";AAAA,OAAO,WAAW;;;ACAlB;AAAA,EACE,MAAQ;AAAA,EACR,SAAW;AAAA,EACX,aAAe;AAAA,EACf,SAAW;AAAA,IACT,OAAS;AAAA,IACT,MAAQ;AAAA,IACR,QAAU;AAAA,IACV,eAAe;AAAA,IACf,WAAa;AAAA,IACb,SAAW;AAAA,EACb;AAAA,EACA,eAAiB;AAAA,IACf,QAAU;AAAA,EACZ;AAAA,EACA,UAAY,CAAC;AAAA,EACb,QAAU;AAAA,EACV,SAAW;AAAA,EACX,iBAAmB;AAAA,IACjB,mBAAmB;AAAA,IACnB,mBAAmB;AAAA,IACnB,kBAAkB;AAAA,IAClB,iBAAiB;AAAA,IACjB,mBAAmB;AAAA,IACnB,eAAe;AAAA,IACf,UAAY;AAAA,IACZ,MAAQ;AAAA,IACR,YAAc;AAAA,IACd,QAAU;AAAA,EACZ;AAAA,EACA,OAAS;AAAA,IACP;AAAA,IACA;AAAA,EACF;AAAA,EACA,MAAQ;AAAA,EACR,QAAU;AAAA,EACV,OAAS;AAAA,EACT,cAAgB;AAAA,IACd,gCAAgC;AAAA,IAChC,oBAAoB;AAAA,IACpB,qBAAqB;AAAA,IACrB,OAAS;AAAA,IACT,YAAY;AAAA,IACZ,MAAQ;AAAA,IACR,eAAe;AAAA,IACf,WAAW;AAAA,IACX,QAAU;AAAA,IACV,UAAY;AAAA,IACZ,SAAW;AAAA,IACX,KAAO;AAAA,EACT;AAAA,EACA,aAAe;AAAA,IACb,SAAW;AAAA,EACb;AAAA,EACA,YAAc;AAAA,IACZ,MAAQ;AAAA,IACR,KAAO;AAAA,EACT;AAAA,EACA,MAAQ;AAAA,IACN,KAAO;AAAA,EACT;AAAA,EACA,UAAY;AACd;;;ADrDA,IAAO,uBAAQ,OAAO,eAAwB;AAC5C,QAAM,cAAc,QAAQ,IAAI,qCAAqC,cAAc;AAEnF,MAAI,CAAC,aAAa;AAChB,YAAQ,IAAI,MAAM,MAAM;AAAA,0CAA6C,CAAC;AACtE,YAAQ,IAAI,MAAM,UAAU;AAAA,8EAAiF,CAAC;AAC9G,YAAQ,KAAK,CAAC;AAAA,EAChB;AAGA,QAAM,WAAW,MAAM,MAAM,uDAAuD;AAAA,IAClF,QAAQ;AAAA,IACR,SAAS;AAAA,MACP,eAAe,UAAU,WAAW;AAAA,MACpC,gBAAgB;AAAA,IAClB;AAAA,EACF,CAAC;AAED,MAAI,SAAS,WAAW,KAAK;AAC3B,YAAQ,IAAI,MAAM,MAAM;AAAA,oBAAuB,CAAC;AAChD,YAAQ,IAAI,MAAM,UAAU,2FAA2F,CAAC;AACxH,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,MAAI,SAAS,WAAW,KAAK;AAC3B,UAAM,OAAQ,MAAM,SAAS,KAAK;AAElC,QAAI,gBAAI,SAAS,KAAK,QAAQ;AAC5B,cAAQ,IAAI,MAAM,MAAM;AAAA,oCAAuC,CAAC;AAChE,cAAQ,IAAI,MAAM,UAAU,2FAA2F,CAAC;AACxH,cAAQ,KAAK,CAAC;AAAA,IAChB;AAEA,QAAI,KAAK,UAAU;AACjB,cAAQ,IAAI,MAAM,OAAO;AAAA,8CAAiD,CAAC;AAAA,IAC7E;AAAA,EACF;AAEA,SAAO,QAAQ,QAAQ;AACzB;","names":[]}